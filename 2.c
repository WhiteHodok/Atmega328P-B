#include <avr/io.h>         // Подключение библиотеки для работы с регистрами ввода-вывода AVR
#include <util/delay.h>     // Подключение библиотеки для создания программных задержек

#define BUTTON_PIN PD0      // Объявление макроса: кнопка подключена к пину PD0
#define LED_PORT PORTB      // Объявление макроса: порт для управления светодиодами — PORTB
#define LED_DDR DDRB        // Объявление макроса: регистр направления данных для светодиодов — DDRB

// Функция инициализации портов
void init_ports() {
    LED_DDR = 0xFF;          // Устанавливаем все пины порта B как выходы (1 = выход)
    LED_PORT = 0x00;         // Устанавливаем низкий уровень на всех выходах порта B (все светодиоды выключены)

    DDRD &= ~(1 << BUTTON_PIN);  // Устанавливаем пин PD0 как вход (обнуляем соответствующий бит в DDRD)
    PORTD |= (1 << BUTTON_PIN);  // Включаем внутренний подтягивающий резистор для пина PD0
}

// Функция последовательного включения четных светодиодов: PB0, PB2, PB4, PB6
void turn_on_even_leds_sequentially() {
    for (uint8_t i = 0; i < 8; i += 2) {        // Перебираем четные номера пинов от 0 до 6
        LED_PORT |= (1 << i);                  // Устанавливаем соответствующий бит в PORTB — включаем светодиод
        _delay_ms(200);                        // Задержка 200 мс для наглядности
    }
}

// Функция последовательного выключения нечетных светодиодов: PB7, PB5, PB3, PB1
void turn_off_odd_leds_sequentially() {
    for (int8_t i = 7; i >= 0; i -= 2) {        // Перебираем нечетные номера пинов от 7 до 1 в обратном порядке
        LED_PORT &= ~(1 << i);                 // Сбрасываем соответствующий бит в PORTB — выключаем светодиод
        _delay_ms(200);                        // Задержка 200 мс для наглядности
    }
}

int main(void) {
    init_ports();    // Инициализируем порты

    while (1) {      // Бесконечный цикл
        if (!(PIND & (1 << BUTTON_PIN))) {     // Проверяем, нажата ли кнопка (низкий уровень на PD0)
            _delay_ms(50);                     // Небольшая задержка для устранения дребезга контактов (дебаунс)

            turn_on_even_leds_sequentially();  // Включаем четные светодиоды по очереди
            _delay_ms(1000);                   // Ждём 1 секунду перед следующим действием
            turn_off_odd_leds_sequentially();  // Выключаем нечетные светодиоды по очереди
        }
    }

    return 0; // Эта строка никогда не выполняется, но добавлена для соответствия стандарту
}
